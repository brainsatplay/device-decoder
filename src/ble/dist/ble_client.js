(()=>{var Pe=Object.create;var K=Object.defineProperty;var xe=Object.getOwnPropertyDescriptor;var Le=Object.getOwnPropertyNames;var Ee=Object.getPrototypeOf,_e=Object.prototype.hasOwnProperty;var W=(s,e)=>()=>(s&&(e=s(s=0)),e);var Ae=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports),Ce=(s,e)=>{for(var t in e)K(s,t,{get:e[t],enumerable:!0})},Be=(s,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Le(e))!_e.call(s,n)&&n!==t&&K(s,n,{get:()=>e[n],enumerable:!(i=xe(e,n))||i.enumerable});return s};var Fe=(s,e,t)=>(t=s!=null?Pe(Ee(s)):{},Be(e||!s||!s.__esModule?K(t,"default",{value:s,enumerable:!0}):t,s));var Ie,Se,ae,He,je,T,U,Oe,Te,Ve,L,oe,ze,M,N=W(()=>{Ie=s=>{let e=new Map;e.set("web",{name:"web"});let t=s.CapacitorPlatforms||{currentPlatform:{name:"web"},platforms:e},i=(r,a)=>{t.platforms.set(r,a)},n=r=>{t.platforms.has(r)&&(t.currentPlatform=t.platforms.get(r))};return t.addPlatform=i,t.setPlatform=n,t},Se=s=>s.CapacitorPlatforms=Ie(s),ae=Se(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),He=ae.addPlatform,je=ae.setPlatform;(function(s){s.Unimplemented="UNIMPLEMENTED",s.Unavailable="UNAVAILABLE"})(T||(T={}));U=class extends Error{constructor(e,t){super(e),this.message=e,this.code=t}},Oe=s=>{var e,t;return s?.androidBridge?"android":!((t=(e=s?.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||t===void 0)&&t.bridge?"ios":"web"},Te=s=>{var e,t,i,n,r;let a=s.CapacitorCustomPlatform||null,o=s.Capacitor||{},c=o.Plugins=o.Plugins||{},l=s.CapacitorPlatforms,b=()=>a!==null?a.name:Oe(s),w=((e=l?.currentPlatform)===null||e===void 0?void 0:e.getPlatform)||b,E=()=>w()!=="web",_=((t=l?.currentPlatform)===null||t===void 0?void 0:t.isNativePlatform)||E,q=d=>{let v=I.get(d);return!!(v?.platforms.has(w())||A(d))},Q=((i=l?.currentPlatform)===null||i===void 0?void 0:i.isPluginAvailable)||q,Y=d=>{var v;return(v=o.PluginHeaders)===null||v===void 0?void 0:v.find(S=>S.name===d)},A=((n=l?.currentPlatform)===null||n===void 0?void 0:n.getPluginHeader)||Y,F=d=>s.console.error(d),C=(d,v,S)=>Promise.reject(`${S} does not have an implementation of "${v}".`),I=new Map,be=(d,v={})=>{let S=I.get(d);if(S)return console.warn(`Capacitor plugin "${d}" already registered. Cannot register plugins twice.`),S.proxy;let B=w(),O=A(d),y,me=async()=>(!y&&B in v?y=typeof v[B]=="function"?y=await v[B]():y=v[B]:a!==null&&!y&&"web"in v&&(y=typeof v.web=="function"?y=await v.web():y=v.web),y),ye=(h,g)=>{var m,P;if(O){let x=O?.methods.find(p=>g===p.name);if(x)return x.rtype==="promise"?p=>o.nativePromise(d,g.toString(),p):(p,k)=>o.nativeCallback(d,g.toString(),p,k);if(h)return(m=h[g])===null||m===void 0?void 0:m.bind(h)}else{if(h)return(P=h[g])===null||P===void 0?void 0:P.bind(h);throw new U(`"${d}" plugin is not implemented on ${B}`,T.Unimplemented)}},J=h=>{let g,m=(...P)=>{let x=me().then(p=>{let k=ye(p,h);if(k){let R=k(...P);return g=R?.remove,R}else throw new U(`"${d}.${h}()" is not implemented on ${B}`,T.Unimplemented)});return h==="addListener"&&(x.remove=async()=>g()),x};return m.toString=()=>`${h.toString()}() { [capacitor code] }`,Object.defineProperty(m,"name",{value:h,writable:!1,configurable:!1}),m},ne=J("addListener"),re=J("removeListener"),De=(h,g)=>{let m=ne({eventName:h},g),P=async()=>{let p=await m;re({eventName:h,callbackId:p},g)},x=new Promise(p=>m.then(()=>p({remove:P})));return x.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await P()},x},X=new Proxy({},{get(h,g){switch(g){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return O?De:ne;case"removeListener":return re;default:return J(g)}}});return c[d]=X,I.set(d,{name:d,proxy:X,platforms:new Set([...Object.keys(v),...O?[B]:[]])}),X},pe=((r=l?.currentPlatform)===null||r===void 0?void 0:r.registerPlugin)||be;return o.convertFileSrc||(o.convertFileSrc=d=>d),o.getPlatform=w,o.handleError=F,o.isNativePlatform=_,o.isPluginAvailable=Q,o.pluginMethodNoop=C,o.registerPlugin=pe,o.Exception=U,o.DEBUG=!!o.DEBUG,o.isLoggingEnabled=!!o.isLoggingEnabled,o.platform=o.getPlatform(),o.isNative=o.isNativePlatform(),o},Ve=s=>s.Capacitor=Te(s),L=Ve(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),oe=L.registerPlugin,ze=L.Plugins,M=class{constructor(e){this.listeners={},this.windowListeners={},e&&(console.warn(`Capacitor WebPlugin "${e.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=e)}addListener(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t);let n=this.windowListeners[e];n&&!n.registered&&this.addWindowListener(n);let r=async()=>this.removeListener(e,t),a=Promise.resolve({remove:r});return Object.defineProperty(a,"remove",{value:async()=>{console.warn("Using addListener() without 'await' is deprecated."),await r()}}),a}async removeAllListeners(){this.listeners={};for(let e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t){let i=this.listeners[e];i&&i.forEach(n=>n(t))}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:i=>{this.notifyListeners(t,i)}}}unimplemented(e="not implemented"){return new L.Exception(e,T.Unimplemented)}unavailable(e="not available"){return new L.Exception(e,T.Unavailable)}async removeListener(e,t){let i=this.listeners[e];if(!i)return;let n=i.indexOf(t);this.listeners[e].splice(n,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){!e||(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}}});function qe(s){return new DataView(Uint8Array.from(s).buffer)}function Ue(s){return Array.from(new Uint8Array(s.buffer))}function ke(s){return`0000${s.toString(16).padStart(4,"0")}-0000-1000-8000-00805f9b34fb`}function V(s){let e=s.trim().split(" ").filter(t=>t!=="").map(t=>parseInt(t,16));return qe(e)}function $(s){return Ue(s).map(e=>{let t=e.toString(16);return t.length==1&&(t="0"+t),t}).join(" ")}function ce(s){if(typeof s=="string")return s;if(typeof s=="number")return ke(s);throw new Error("Invalid UUID")}function Z(s){let e={};if(!!s)return s.forEach((t,i)=>{e[i.toString()]=t}),e}var H=W(()=>{});async function le(s,e,t){let i;return Promise.race([s,new Promise((n,r)=>{i=setTimeout(()=>r(t),e)})]).finally(()=>clearTimeout(i))}var ue=W(()=>{});var de={};Ce(de,{BluetoothLeWeb:()=>ee});var ee,ve=W(()=>{N();H();ue();ee=class extends M{constructor(){super(...arguments),this.deviceMap=new Map,this.discoveredDevices=new Map,this.scan=null,this.DEFAULT_CONNECTION_TIMEOUT=1e4,this.onAdvertisementReceivedCallback=this.onAdvertisementReceived.bind(this),this.onDisconnectedCallback=this.onDisconnected.bind(this),this.onCharacteristicValueChangedCallback=this.onCharacteristicValueChanged.bind(this)}async initialize(){if(typeof navigator>"u"||!navigator.bluetooth)throw this.unavailable("Web Bluetooth API not available in this browser.");if(!await navigator.bluetooth.getAvailability())throw this.unavailable("No Bluetooth radio available.")}async isEnabled(){return{value:!0}}async enable(){throw this.unavailable("enable is not available on web.")}async disable(){throw this.unavailable("disable is not available on web.")}async startEnabledNotifications(){}async stopEnabledNotifications(){}async isLocationEnabled(){throw this.unavailable("isLocationEnabled is not available on web.")}async openLocationSettings(){throw this.unavailable("openLocationSettings is not available on web.")}async openBluetoothSettings(){throw this.unavailable("openBluetoothSettings is not available on web.")}async openAppSettings(){throw this.unavailable("openAppSettings is not available on web.")}async setDisplayStrings(){}async requestDevice(e){let t=this.getFilters(e),i=await navigator.bluetooth.requestDevice({filters:t.length?t:void 0,optionalServices:e?.optionalServices,acceptAllDevices:t.length===0});return this.deviceMap.set(i.id,i),this.getBleDevice(i)}async requestLEScan(e){this.requestBleDeviceOptions=e;let t=this.getFilters(e);await this.stopLEScan(),this.discoveredDevices=new Map,navigator.bluetooth.removeEventListener("advertisementreceived",this.onAdvertisementReceivedCallback),navigator.bluetooth.addEventListener("advertisementreceived",this.onAdvertisementReceivedCallback),this.scan=await navigator.bluetooth.requestLEScan({filters:t.length?t:void 0,acceptAllAdvertisements:t.length===0,keepRepeatedDevices:e?.allowDuplicates})}onAdvertisementReceived(e){var t,i;let n=e.device.id;if(this.deviceMap.set(n,e.device),!this.discoveredDevices.has(n)||((t=this.requestBleDeviceOptions)===null||t===void 0?void 0:t.allowDuplicates)){this.discoveredDevices.set(n,!0);let a=this.getBleDevice(e.device),o={device:a,localName:a.name,rssi:e.rssi,txPower:e.txPower,manufacturerData:Z(e.manufacturerData),serviceData:Z(e.serviceData),uuids:(i=e.uuids)===null||i===void 0?void 0:i.map(ce)};this.notifyListeners("onScanResult",o)}}async stopLEScan(){var e;!((e=this.scan)===null||e===void 0)&&e.active&&this.scan.stop(),this.scan=null}async getDevices(e){return{devices:(await navigator.bluetooth.getDevices()).map(n=>(this.deviceMap.set(n.id,n),this.getBleDevice(n)))}}async getConnectedDevices(e){return{devices:(await navigator.bluetooth.getDevices()).filter(n=>{var r;return(r=n.gatt)===null||r===void 0?void 0:r.connected}).map(n=>(this.deviceMap.set(n.id,n),this.getBleDevice(n)))}}async connect(e){var t,i;let n=this.getDeviceFromMap(e.deviceId);n.removeEventListener("gattserverdisconnected",this.onDisconnectedCallback),n.addEventListener("gattserverdisconnected",this.onDisconnectedCallback);let r=Symbol();if(n.gatt===void 0)throw new Error("No gatt server available.");try{let a=(t=e.timeout)!==null&&t!==void 0?t:this.DEFAULT_CONNECTION_TIMEOUT;await le(n.gatt.connect(),a,r)}catch(a){throw await((i=n.gatt)===null||i===void 0?void 0:i.disconnect()),a===r?new Error("Connection timeout"):a}}onDisconnected(e){let i=`disconnected|${e.target.id}`;this.notifyListeners(i,null)}async createBond(e){throw this.unavailable("createBond is not available on web.")}async isBonded(e){throw this.unavailable("isBonded is not available on web.")}async disconnect(e){var t;(t=this.getDeviceFromMap(e.deviceId).gatt)===null||t===void 0||t.disconnect()}async getServices(e){var t,i;let n=(i=await((t=this.getDeviceFromMap(e.deviceId).gatt)===null||t===void 0?void 0:t.getPrimaryServices()))!==null&&i!==void 0?i:[],r=[];for(let a of n){let o=await a.getCharacteristics(),c=[];for(let l of o)c.push({uuid:l.uuid,properties:this.getProperties(l),descriptors:await this.getDescriptors(l)});r.push({uuid:a.uuid,characteristics:c})}return{services:r}}async getDescriptors(e){try{return(await e.getDescriptors()).map(i=>({uuid:i.uuid}))}catch{return[]}}getProperties(e){return{broadcast:e.properties.broadcast,read:e.properties.read,writeWithoutResponse:e.properties.writeWithoutResponse,write:e.properties.write,notify:e.properties.notify,indicate:e.properties.indicate,authenticatedSignedWrites:e.properties.authenticatedSignedWrites,reliableWrite:e.properties.reliableWrite,writableAuxiliaries:e.properties.writableAuxiliaries}}async getCharacteristic(e){var t;let i=await((t=this.getDeviceFromMap(e.deviceId).gatt)===null||t===void 0?void 0:t.getPrimaryService(e?.service));return i?.getCharacteristic(e?.characteristic)}async getDescriptor(e){let t=await this.getCharacteristic(e);return t?.getDescriptor(e?.descriptor)}async readRssi(e){throw this.unavailable("readRssi is not available on web.")}async read(e){let t=await this.getCharacteristic(e);return{value:await t?.readValue()}}async write(e){let t=await this.getCharacteristic(e),i;typeof e.value=="string"?i=V(e.value):i=e.value,await t?.writeValueWithResponse(i)}async writeWithoutResponse(e){let t=await this.getCharacteristic(e),i;typeof e.value=="string"?i=V(e.value):i=e.value,await t?.writeValueWithoutResponse(i)}async readDescriptor(e){let t=await this.getDescriptor(e);return{value:await t?.readValue()}}async writeDescriptor(e){let t=await this.getDescriptor(e),i;typeof e.value=="string"?i=V(e.value):i=e.value,await t?.writeValue(i)}async startNotifications(e){let t=await this.getCharacteristic(e);t?.removeEventListener("characteristicvaluechanged",this.onCharacteristicValueChangedCallback),t?.addEventListener("characteristicvaluechanged",this.onCharacteristicValueChangedCallback),await t?.startNotifications()}onCharacteristicValueChanged(e){var t,i;let n=e.target,r=`notification|${(t=n.service)===null||t===void 0?void 0:t.device.id}|${(i=n.service)===null||i===void 0?void 0:i.uuid}|${n.uuid}`;this.notifyListeners(r,{value:n.value})}async stopNotifications(e){let t=await this.getCharacteristic(e);await t?.stopNotifications()}getFilters(e){var t;let i=[];for(let n of(t=e?.services)!==null&&t!==void 0?t:[])i.push({services:[n],name:e?.name,namePrefix:e?.namePrefix});return(e?.name||e?.namePrefix)&&i.length===0&&i.push({name:e.name,namePrefix:e.namePrefix}),i}getDeviceFromMap(e){let t=this.deviceMap.get(e);if(t===void 0)throw new Error('Device not found. Call "requestDevice", "requestLEScan" or "getDevices" first.');return t}getBleDevice(e){var t;return{deviceId:e.id,name:(t=e.name)!==null&&t!==void 0?t:void 0,uuids:e.uuids}}}});var he=Ae((tt,z)=>{"use strict";function fe(s){var e=new te,t=s|0;function i(c,l,b){return(t|0)!==0?(t=(t|0)-1,new Promise(function(w){w(c.apply(l,b))}).then(r,a)):new Promise(function(w){e.push(new Me(w,c,l,b))}).then(n)}function n(c){try{return Promise.resolve(c.fn.apply(c.self,c.args)).then(r,a)}catch(l){a(l)}}function r(c){return o(),c}function a(c){throw o(),c}function o(){var c=e.shift();c?c.resolve(c):t=(t|0)+1}return i}function Re(s,e){let t=fe(s|0);return function(){for(var i=new Array(arguments.length),n=0;n<arguments.length;n++)i[n]=arguments[n];return t(e,this,i)}}function We(s){let e=fe(s|0);return function(t){if(typeof t!="function")throw new TypeError("Expected throat fn to be a function but got "+typeof t);for(var i=new Array(arguments.length-1),n=1;n<arguments.length;n++)i[n-1]=arguments[n];return e(t,this,i)}}z.exports=function(e,t){if(typeof e=="function"){var i=t;t=e,e=i}if(typeof e!="number")throw new TypeError("Expected throat size to be a number but got "+typeof e);if(t!==void 0&&typeof t!="function")throw new TypeError("Expected throat fn to be a function but got "+typeof t);return typeof t=="function"?Re(e|0,t):We(e|0)};z.exports.default=z.exports;function Me(s,e,t,i){this.resolve=s,this.fn=e,this.self=t||null,this.args=i}var j=64;function te(){this._s1=[],this._s2=[],this._shiftBlock=this._pushBlock=new Array(j),this._pushIndex=0,this._shiftIndex=0}te.prototype.push=function(s){this._pushIndex===j&&(this._pushIndex=0,this._s1[this._s1.length]=this._pushBlock=new Array(j)),this._pushBlock[this._pushIndex++]=s};te.prototype.shift=function(){if(this._shiftIndex===j){this._shiftIndex=0;var s=this._s2;if(s.length===0){var e=this._s1;if(e.length===0)return;this._s1=s,s=this._s2=e.reverse()}this._shiftBlock=s.pop()}if(!(this._pushBlock===this._shiftBlock&&this._pushIndex===this._shiftIndex)){var t=this._shiftBlock[this._shiftIndex];return this._shiftBlock[this._shiftIndex++]=null,t}}});var se;(function(s){s[s.SCAN_MODE_LOW_POWER=0]="SCAN_MODE_LOW_POWER",s[s.SCAN_MODE_BALANCED=1]="SCAN_MODE_BALANCED",s[s.SCAN_MODE_LOW_LATENCY=2]="SCAN_MODE_LOW_LATENCY"})(se||(se={}));N();H();N();var u=oe("BluetoothLe",{web:()=>Promise.resolve().then(()=>(ve(),de)).then(s=>new s.BluetoothLeWeb)});var we=Fe(he());function G(s){return s?(0,we.default)(1):e=>e()}function f(s){if(typeof s!="string")throw new Error(`Invalid UUID type ${typeof s}. Expected string.`);if(s=s.toLowerCase(),!(s.search(/^[0-9a-f]{8}\b-[0-9a-f]{4}\b-[0-9a-f]{4}\b-[0-9a-f]{4}\b-[0-9a-f]{12}$/)>=0))throw new Error(`Invalid UUID format ${s}. Expected 128 bit string (e.g. "0000180d-0000-1000-8000-00805f9b34fb").`);return s}var ie=class{constructor(){this.scanListener=null,this.eventListeners=new Map,this.queue=G(!0)}enableQueue(){this.queue=G(!0)}disableQueue(){this.queue=G(!1)}async initialize(e){await this.queue(async()=>{await u.initialize(e)})}async getEnabled(){return this.isEnabled()}async isEnabled(){return await this.queue(async()=>(await u.isEnabled()).value)}async enable(){await this.queue(async()=>{await u.enable()})}async disable(){await this.queue(async()=>{await u.disable()})}async startEnabledNotifications(e){await this.queue(async()=>{var t;let i="onEnabledChanged";await((t=this.eventListeners.get(i))===null||t===void 0?void 0:t.remove());let n=await u.addListener(i,r=>{e(r.value)});this.eventListeners.set(i,n),await u.startEnabledNotifications()})}async stopEnabledNotifications(){await this.queue(async()=>{var e;let t="onEnabledChanged";await((e=this.eventListeners.get(t))===null||e===void 0?void 0:e.remove()),this.eventListeners.delete(t),await u.stopEnabledNotifications()})}async isLocationEnabled(){return await this.queue(async()=>(await u.isLocationEnabled()).value)}async openLocationSettings(){await this.queue(async()=>{await u.openLocationSettings()})}async openBluetoothSettings(){await this.queue(async()=>{await u.openBluetoothSettings()})}async openAppSettings(){await this.queue(async()=>{await u.openAppSettings()})}async setDisplayStrings(e){await this.queue(async()=>{await u.setDisplayStrings(e)})}async requestDevice(e){return await this.queue(async()=>await u.requestDevice(e))}async requestLEScan(e,t){await this.queue(async()=>{var i;await((i=this.scanListener)===null||i===void 0?void 0:i.remove()),this.scanListener=await u.addListener("onScanResult",n=>{let r=Object.assign(Object.assign({},n),{manufacturerData:this.convertObject(n.manufacturerData),serviceData:this.convertObject(n.serviceData),rawAdvertisement:n.rawAdvertisement?this.convertValue(n.rawAdvertisement):void 0});t(r)}),await u.requestLEScan(e)})}async stopLEScan(){await this.queue(async()=>{var e;await((e=this.scanListener)===null||e===void 0?void 0:e.remove()),this.scanListener=null,await u.stopLEScan()})}async getDevices(e){return this.queue(async()=>(await u.getDevices({deviceIds:e})).devices)}async getConnectedDevices(e){return this.queue(async()=>(await u.getConnectedDevices({services:e})).devices)}async connect(e,t,i){await this.queue(async()=>{var n;if(t){let r=`disconnected|${e}`;await((n=this.eventListeners.get(r))===null||n===void 0?void 0:n.remove());let a=await u.addListener(r,()=>{t(e)});this.eventListeners.set(r,a)}await u.connect(Object.assign({deviceId:e},i))})}async createBond(e){await this.queue(async()=>{await u.createBond({deviceId:e})})}async isBonded(e){return await this.queue(async()=>(await u.isBonded({deviceId:e})).value)}async disconnect(e){await this.queue(async()=>{await u.disconnect({deviceId:e})})}async getServices(e){return await this.queue(async()=>(await u.getServices({deviceId:e})).services)}async readRssi(e){return await this.queue(async()=>{let i=await u.readRssi({deviceId:e});return parseFloat(i.value)})}async read(e,t,i,n){return t=f(t),i=f(i),await this.queue(async()=>{let a=await u.read(Object.assign({deviceId:e,service:t,characteristic:i},n));return this.convertValue(a.value)})}async write(e,t,i,n,r){return t=f(t),i=f(i),this.queue(async()=>{if(!n?.buffer)throw new Error("Invalid data.");let a=n;L.getPlatform()!=="web"&&(a=$(n)),await u.write(Object.assign({deviceId:e,service:t,characteristic:i,value:a},r))})}async writeWithoutResponse(e,t,i,n,r){t=f(t),i=f(i),await this.queue(async()=>{if(!n?.buffer)throw new Error("Invalid data.");let a=n;L.getPlatform()!=="web"&&(a=$(n)),await u.writeWithoutResponse(Object.assign({deviceId:e,service:t,characteristic:i,value:a},r))})}async readDescriptor(e,t,i,n,r){return t=f(t),i=f(i),n=f(n),await this.queue(async()=>{let o=await u.readDescriptor(Object.assign({deviceId:e,service:t,characteristic:i,descriptor:n},r));return this.convertValue(o.value)})}async writeDescriptor(e,t,i,n,r,a){return t=f(t),i=f(i),n=f(n),this.queue(async()=>{if(!r?.buffer)throw new Error("Invalid data.");let o=r;L.getPlatform()!=="web"&&(o=$(r)),await u.writeDescriptor(Object.assign({deviceId:e,service:t,characteristic:i,descriptor:n,value:o},a))})}async startNotifications(e,t,i,n){t=f(t),i=f(i),await this.queue(async()=>{var r;let a=`notification|${e}|${t}|${i}`;await((r=this.eventListeners.get(a))===null||r===void 0?void 0:r.remove());let o=await u.addListener(a,c=>{n(this.convertValue(c?.value))});this.eventListeners.set(a,o),await u.startNotifications({deviceId:e,service:t,characteristic:i})})}async stopNotifications(e,t,i){t=f(t),i=f(i),await this.queue(async()=>{var n;let r=`notification|${e}|${t}|${i}`;await((n=this.eventListeners.get(r))===null||n===void 0?void 0:n.remove()),this.eventListeners.delete(r),await u.stopNotifications({deviceId:e,service:t,characteristic:i})})}convertValue(e){return typeof e=="string"?V(e):e===void 0?new DataView(new ArrayBuffer(0)):e}convertObject(e){if(e===void 0)return;let t={};for(let i of Object.keys(e))t[i]=this.convertValue(e[i]);return t}},ge=new ie;H();var D=class{constructor(e,t){this.client=ge;this.setupDevice=(e,t)=>new Promise(async(i,n)=>{this.devices[e.deviceId]={device:e,options:t},this.client.connect(e.deviceId,t.onDisconnect,t.connectOptions).then(async()=>{for(let r in t.services)for(let a in t.services[r]){let o=t.services[r][a];o.write&&await this.write(e,r,a,o.write,o.writeCallback,o.writeOptions),o.read&&await this.read(e,r,a,o.readCallback,o.readOptions),o.notify&&o.notifyCallback&&(await this.subscribe(e,r,a,o.notifyCallback),o.notifying=!0)}}),i(this.devices[e.deviceId])});this.triangulate=(e,t=1500,i=60)=>new Promise((n,r)=>{if("Accelerometer"in globalThis){if(typeof globalThis.Accelerometer=="function"){let a=new globalThis.Accelerometer({frequency:i}),o=performance.now(),c=o,l={samples:[],vector:{}},b=()=>{if(c-o<t)this.readRssi(e).then(w=>{let E=a.x,_=a.y,q=a.z;c=performance.now(),l.samples.push({x:E,y:_,z:q,rssi:w,timestamp:c})});else{let w={x:0,y:0,z:0,rssiAvg:0};l.samples.forEach(E=>{}),a.removeEventListener("reading",b)}};a.addEventListener("reading",b)}}else r(new Error("No Accelerometer API detected"))});t&&(this.location=t)}setup(e,t=this.location){let i=[];for(let a in e.services)i.push(a);let n={services:i,optionalServices:i};e.namePrefix&&(n.namePrefix=e.namePrefix);let r={};return t||(r.androidNeverForLocation=!1),new Promise((a,o)=>{this.client.initialize(r).then(()=>{e.deviceId?this.reconnect(e.deviceId).then(c=>{a(this.setupDevice(c,e))}):this.client.requestDevice(n).then(c=>{a(this.setupDevice(c,e))})})})}initialize(e){return new Promise((t,i)=>{this.client.initialize(e).then(()=>{t(!0)}).catch(i)})}requestDevice(e,t){return new Promise((i,n)=>{this.client.requestDevice(e).then(r=>{this.devices[r.deviceId]={device:r,options:t},i(r)}).catch(n)})}connect(e,t){return new Promise((i,n)=>{this.client.connect(e.deviceId,t.onDisconnect,t.connectOptions).then(r=>{i(e)}).catch(n)})}reconnect(e){return new Promise((t,i)=>{this.client.getDevices([e]).then(n=>{t(n[0])}).catch(i)})}disconnect(e){return this.client.disconnect(e.deviceId)}write(e,t,i,n,r,a){return r?this.client.write(e.deviceId,t,i,D.toDataView(n)).then(r):this.client.writeWithoutResponse(e.deviceId,t,i,D.toDataView(n),a)}read(e,t,i,n,r){return n?this.client.read(e.deviceId,t,i,r).then(n):this.client.read(e.deviceId,t,i,r)}subscribe(e,t,i,n){return this.client.startNotifications(e.deviceId,t,i,n)}unsubscribe(e,t,i){return this.client.stopNotifications(e.deviceId,t,i)}scan(e,t){return this.client.requestLEScan(e,t)}stopScanning(){return this.client.stopLEScan()}readDescriptor(e,t,i,n,r){return this.client.readDescriptor(e.deviceId,t,i,n,r)}writeDescriptor(e,t,i,n,r,a){return this.client.writeDescriptor(e.deviceId,t,i,n,D.toDataView(r),a)}readRssi(e){return this.client.readRssi(e.deviceId)}async distance(e,t,i,n,r){let a=await this.readRssi(e);if(a==0)return;let o=a/t;return o<1?Math.pow(o,10):i*Math.pow(o,n)+r}async distanceFromPhone(e,t,i){let n,r,a;return i&&(i==="nexus5"?(n=.42093,r=6.9476,a=.54992):i==="motoX"?(n=.9401940951,r=6.170094565,a=0):i==="iphone5"&&(n=.89976,r=7.7095,a=.111)),await this.distance(e,t,n,r,a)}static toDataView(e){if(!(e instanceof DataView))if(typeof e=="string"){let t=new TextEncoder;e=new DataView(t.encode(e))}else if(typeof e=="number"){let t=e;e<256?(e=new DataView(new ArrayBuffer(1)),e.setUint8(0,t)):e<65536?(e=new DataView(new ArrayBuffer(2)),e.setInt16(0,t)):(e=new DataView(new ArrayBuffer(4)),e.setUint32(0,t))}else e instanceof ArrayBuffer||e instanceof SharedArrayBuffer?e=new DataView(e):Array.isArray(e)&&(e=new DataView(Uint8Array.from(e)));return e}static searchBuffer(e,t,i){for(var n=t,r=e,a=D.boyerMoore(n),o=a.byteLength,c=[],l=a(r);l!==-1&&(c.push(l),!(i&&c.length>=i));l=a(r,l+o));return c}static bytesToInt16(e,t){let i=(255&e)<<8|255&t;return(i&32768)>0?i|=4294901760:i&=65535,i}static bytesToUInt16(e,t){return e*256+t}static Uint16ToBytes(e){return[e&255,e>>8&255]}static bytesToInt24(e,t,i){let n=(255&e)<<16|(255&t)<<8|255&i;return(n&8388608)>0?n|=4278190080:n&=16777215,n}static bytesToUInt24(e,t,i){return e*65536+t*256+i}static Uint24ToBytes(e){return[e&255,e>>8&255,e>>16&255]}static bytesToInt32(e,t,i,n){let r=(255&e)<<24|(255&t)<<16|(255&i)<<8|255&n;return(r&2147483648)>0?r|=0:r&=4294967295,r}static bytesToUInt32(e,t,i,n){return e*16777216+t*65536+i*256+n}static Uint32ToBytes(e){return[e&255,e>>8&255,e>>16&255,e>>24&255]}static get2sCompliment(e,t){return e>4294967296?null:e<<32-t>>32-t}static getSignedInt(...e){let t=0;function i(n){for(var r=0,a=!0;n--;)if(a){let o=e[t++];r+=o&127,o&128&&(r-=128),a=!1}else r*=256,r+=e[t++];return r}return i(e.length)}static asUint8Array(e){if(e instanceof Uint8Array)return e;if(typeof e=="string"){for(var t=new Uint8Array(e.length),i=0;i<e.length;i++){var n=e.charCodeAt(i);if(n>127)throw new TypeError("Only ASCII patterns are supported");t[i]=n}return t}else return new Uint8Array(e)}static boyerMoore(e){var t=D.asUint8Array(e),i=t.length;if(i===0)throw new TypeError("patternBuffer must be at least 1 byte long");for(var n=256,r=new Int32Array(n),a=0;a<n;a++)r[a]=-1;for(var o=0;o<i;o++)r[t[o]]=o;var c=(l,b,w)=>{var E=D.asUint8Array(l);b===void 0&&(b=0),w===void 0&&(w=E.length);for(var _=t,q=r,Q=w-_.length,Y=_.length-1,A,F=b;F<=Q;F+=A){A=0;for(var C=Y;C>=0;C--){var I=E[F+C];if(_[C]!==I){A=Math.max(1,C-q[I]);break}}if(A===0)return F}return-1};return c.byteLength=t.byteLength,c}};})();
/*! Capacitor: https://capacitorjs.com/ - MIT License */
